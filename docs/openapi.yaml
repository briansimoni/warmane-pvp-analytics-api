openapi: 3.0.0
info:
  title: Warmane Analytics API
  description: This API provides the interface into the data to find out how much of a dog a player might be
  version: 1.0.0
paths:
  /character:
    get:
      summary: Get Warmane character metadata
      parameters:
        - name: name
          in: query
          required: true
          schema:
            type: string
        - name: realm
          in: query
          required: true
          schema:
            type: string
      responses:
        200:
          description: Successfully retrieved character meta data. SCHEMA TBD

  /character/crawl-status:
    get:
      summary: Get the crawler status
      description: |
        The crawler is highly constrained on how frequent it can be run. Clients will need
        to know when the last time it ran is, and when it is finished so it can know when
        to start downloading match history
      parameters:
        - name: name
          in: query
          required: true
          schema:
            type: string
        - name: realm
          in: query
          required: true
          schema:
            type: string
      responses:
        200:
          description: Successfully retrieved character data
          application/json:
            schema:
              type: object
              properties:
                status:
                  type: string
                  enum: [idle, crawling]
                last_started:
                  type: string
                  description: ISO 8601 string indicated when the crawler last started

  /character/matches:
    get:
      parameters:
        - name: name
          in: query
          required: true
          schema:
            type: string
        - name: realm
          in: query
          required: true
          schema:
            type: string
        - name: paginationToken
          in: query
          schema:
            type: string
          description: opaque string that tells the backend where to continue loading database data
      responses:
        200:
          description: TBD. It will probably be an object that contains two properties, matches array, and continuation token if there is one

  /crawl:
    post:
      summary: Start Warmane character data crawl
      description: Initiates a crawl of Warmane character data based on the user search parameters provided.
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                realm:
                  type: string
              required:
                - name
                - realm
              additionalProperties: false
      responses:
        200:
          description: Crawl started successfully
